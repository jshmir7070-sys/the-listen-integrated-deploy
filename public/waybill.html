<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ìš´ì†¡ì¥ ì…ë ¥ - The Listen</title>
<style>
  :root{--brand:#007bff;--bg:#f7f9fc;--card:#fff;}
  body{margin:0;background:var(--bg);font-family:"Noto Sans KR",sans-serif}
  header{background:var(--brand);color:#fff;text-align:center;padding:12px;font-weight:900}
  .wrap{max-width:480px;margin:auto;padding:14px}
  .input-group{display:flex;align-items:center;gap:8px;margin-bottom:10px}
  input[type="number"]{flex:1;padding:12px;font-size:16px;border:1px solid #ccc;border-radius:10px}
  .btn{padding:12px 14px;border:none;border-radius:10px;background:#007bff;color:#fff;font-weight:700;cursor:pointer;width:100%}
  .icon-btn{background:#007bff;color:#fff;border:none;border-radius:10px;padding:12px;font-size:18px;cursor:pointer}
</style>
</head>
<body>
<header>ğŸ“¦ ìš´ì†¡ì¥ ì…ë ¥ (The Listen)</header>
<div class="wrap">
  <div class="input-group">
    <input id="waybill" type="number" inputmode="numeric" placeholder="ìš´ì†¡ì¥ ë²ˆí˜¸ ì…ë ¥" />
    <button class="icon-btn" id="cameraBtn">ğŸ“·</button>
  </div>
  <button class="btn" id="addBtn">ì¶”ê°€</button>
  <button class="btn" style="background:#6b7280;margin-top:8px" id="backBtn">â¬…ï¸ ë’¤ë¡œê°€ê¸°</button>
</div>

<script>
let customers=JSON.parse(localStorage.getItem("customers")||"[]");
let scanned=JSON.parse(localStorage.getItem("waybills")||"[]");

document.getElementById("addBtn").onclick=()=>{
  const v=document.getElementById("waybill").value.trim();
  if(!v) return alert("ìš´ì†¡ì¥ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
  ding();
  const c={id:v,name:"ê³ ê°"+(customers.length+1),phone:"010-0000-0000",address:"ê²½ê¸°ë„ ì‹œí¥ì‹œ ì¡°ë‚¨ë™ "+(100+customers.length)+"ë™ "+(200+customers.length)+"í˜¸",boxes:1};
  mergeCustomer(c);
  document.getElementById("waybill").value='';
};

document.getElementById("backBtn").onclick=()=>location.href="depart.html";

document.getElementById("cameraBtn").onclick=()=>alert("ğŸ“¸ í›„ë©´ì¹´ë©”ë¼ ì‘ë™ (ëª¨ë°”ì¼ ì „ìš©)");

function mergeCustomer(newC){
  let same=customers.find(c=>(c.address===newC.address && c.name===newC.name));
  if(same) same.boxes+=newC.boxes;
  else customers.push(newC);
  scanned.push({code:newC.id,time:new Date().toISOString()});
  localStorage.setItem("customers",JSON.stringify(customers));
  localStorage.setItem("waybills",JSON.stringify(scanned));
  alert("ìš´ì†¡ì¥ ë“±ë¡ ì™„ë£Œ!");
}

function ding(){
  const a=new Audio("https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg");a.play();
}
</script>
</body>
</html>
